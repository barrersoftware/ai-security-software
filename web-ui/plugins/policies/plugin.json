{
  "name": "policies",
  "version": "1.0.0",
  "displayName": "Custom Scanning Policies",
  "description": "Define, schedule, and execute custom security scanning policies with compliance templates",
  "author": "AI Security Scanner Team",
  "license": "MIT",
  "enabled": true,
  "dependencies": ["auth", "tenants", "scanner", "audit-log"],
  "loadPriority": 70,
  "category": "security",
  "capabilities": [
    "policy-management",
    "compliance-templates",
    "scheduled-scanning",
    "policy-execution",
    "compliance-tracking",
    "tenant-policies"
  ],
  "services": [
    {
      "name": "PolicyManager",
      "description": "Create, update, delete, and manage security policies",
      "singleton": true
    },
    {
      "name": "PolicyScheduler",
      "description": "Schedule policies for automated execution (cron-like)",
      "singleton": true
    },
    {
      "name": "PolicyExecutor",
      "description": "Execute policies and track results",
      "singleton": true
    },
    {
      "name": "TemplateManager",
      "description": "Manage policy templates for compliance frameworks",
      "singleton": true
    },
    {
      "name": "ComplianceTracker",
      "description": "Track compliance scores and history over time",
      "singleton": true
    }
  ],
  "config": {
    "maxPoliciesPerTenant": {
      "default": 50,
      "description": "Maximum number of policies per tenant"
    },
    "defaultSchedule": {
      "default": "0 2 * * *",
      "description": "Default cron schedule (2 AM daily)"
    },
    "retentionDays": {
      "default": 365,
      "description": "Days to retain policy execution history"
    },
    "concurrentExecutions": {
      "default": 5,
      "description": "Maximum concurrent policy executions"
    }
  },
  "templates": [
    {
      "id": "pci-dss",
      "name": "PCI-DSS 3.2.1",
      "description": "Payment Card Industry Data Security Standard",
      "script": "scan-compliance.sh",
      "framework": "pci-dss",
      "category": "industry"
    },
    {
      "id": "hipaa",
      "name": "HIPAA Security Rule",
      "description": "Health Insurance Portability and Accountability Act",
      "script": "scan-compliance.sh",
      "framework": "hipaa",
      "category": "industry"
    },
    {
      "id": "soc2",
      "name": "SOC 2 Type II",
      "description": "Service Organization Control 2",
      "script": "scan-compliance.sh",
      "framework": "soc2",
      "category": "industry"
    },
    {
      "id": "gdpr",
      "name": "GDPR",
      "description": "General Data Protection Regulation",
      "script": "scan-compliance.sh",
      "framework": "gdpr",
      "category": "industry"
    },
    {
      "id": "iso27001",
      "name": "ISO 27001:2022",
      "description": "Information Security Management System",
      "script": "scan-iso27001.sh",
      "framework": "iso27001",
      "category": "industry"
    },
    {
      "id": "nist-csf",
      "name": "NIST CSF 2.0",
      "description": "NIST Cybersecurity Framework",
      "script": "scan-nist.sh",
      "framework": "csf",
      "category": "government"
    },
    {
      "id": "nist-800-53",
      "name": "NIST SP 800-53",
      "description": "Security and Privacy Controls",
      "script": "scan-nist.sh",
      "framework": "800-53",
      "category": "government"
    },
    {
      "id": "nist-800-171",
      "name": "NIST SP 800-171",
      "description": "Protecting Controlled Unclassified Information",
      "script": "scan-nist.sh",
      "framework": "800-171",
      "category": "government"
    },
    {
      "id": "disa-stig",
      "name": "DISA STIG",
      "description": "Defense Information Systems Agency Security Technical Implementation Guides",
      "script": "scan-disa-stig.sh",
      "framework": "stig",
      "category": "defense"
    },
    {
      "id": "openscap",
      "name": "OpenSCAP",
      "description": "Security Content Automation Protocol",
      "script": "scan-openscap.sh",
      "framework": "scap",
      "category": "automated"
    }
  ],
  "api": {
    "endpoints": [
      {
        "method": "POST",
        "path": "/api/policies",
        "description": "Create a new policy",
        "auth": "required",
        "roles": ["admin", "security"]
      },
      {
        "method": "GET",
        "path": "/api/policies",
        "description": "List policies (tenant-scoped)",
        "auth": "required",
        "roles": ["admin", "security", "auditor"]
      },
      {
        "method": "GET",
        "path": "/api/policies/:id",
        "description": "Get policy details",
        "auth": "required",
        "roles": ["admin", "security", "auditor"]
      },
      {
        "method": "PUT",
        "path": "/api/policies/:id",
        "description": "Update policy",
        "auth": "required",
        "roles": ["admin", "security"]
      },
      {
        "method": "DELETE",
        "path": "/api/policies/:id",
        "description": "Delete policy",
        "auth": "required",
        "roles": ["admin"]
      },
      {
        "method": "POST",
        "path": "/api/policies/:id/execute",
        "description": "Execute policy immediately",
        "auth": "required",
        "roles": ["admin", "security"]
      },
      {
        "method": "GET",
        "path": "/api/policies/:id/history",
        "description": "Get policy execution history",
        "auth": "required",
        "roles": ["admin", "security", "auditor"]
      },
      {
        "method": "GET",
        "path": "/api/policies/templates",
        "description": "List available policy templates",
        "auth": "required",
        "roles": ["admin", "security"]
      },
      {
        "method": "POST",
        "path": "/api/policies/from-template",
        "description": "Create policy from template",
        "auth": "required",
        "roles": ["admin", "security"]
      },
      {
        "method": "GET",
        "path": "/api/policies/:id/compliance-score",
        "description": "Get current compliance score for policy",
        "auth": "required",
        "roles": ["admin", "security", "auditor"]
      },
      {
        "method": "GET",
        "path": "/api/policies/:id/trend",
        "description": "Get compliance score trend over time",
        "auth": "required",
        "roles": ["admin", "security", "auditor"]
      },
      {
        "method": "POST",
        "path": "/api/policies/:id/schedule",
        "description": "Update policy schedule",
        "auth": "required",
        "roles": ["admin", "security"]
      }
    ]
  },
  "schedules": {
    "types": [
      {
        "id": "daily",
        "name": "Daily",
        "cron": "0 2 * * *",
        "description": "Run at 2 AM every day"
      },
      {
        "id": "weekly",
        "name": "Weekly",
        "cron": "0 2 * * 0",
        "description": "Run at 2 AM every Sunday"
      },
      {
        "id": "monthly",
        "name": "Monthly",
        "cron": "0 2 1 * *",
        "description": "Run at 2 AM on the 1st of each month"
      },
      {
        "id": "quarterly",
        "name": "Quarterly",
        "cron": "0 2 1 */3 *",
        "description": "Run at 2 AM on the 1st every 3 months"
      },
      {
        "id": "custom",
        "name": "Custom",
        "cron": null,
        "description": "Custom cron expression"
      }
    ]
  }
}
